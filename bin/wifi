#!/bin/zsh

. "$DOTPATH"/.zsh/20_functions.zsh

if [ is_cygwin ]; then
    network_info=(`netsh wlan show interfaces | sed -e '/^\s*$/d' -e 's/\s//g' | awk -F : '{print $2}'`)

    state=${network_info[5]}
    ssid=${network_info[6]}
    signal=${network_info[15]}

    case "${state}" in
        "connected")
            signals=(▁ ▂ ▄ ▆ █)
            signal_icon="#[underscore]"
            signal_=`echo $((${signal%\%} / 100.0 * 5 + 1))`

            for ((i=0; i < $signal_; i++ )); do
                signal_icon="${signal_icon}${signals[$i]}"
            done
            signal_icon="${signal_icon}#[default]"
            ;;
        "authenticating")
            signal_icon="#[fg=yellow] ... #[default]"
            ;;
        "disconnected")
            signal_icon="#[fg=red] ✘ #[default]"
            ;;
    esac

    echo "${signal_icon} #[bg=colour027,fg=white] ${ssid} #[bg=default,fg=default]"
fi
